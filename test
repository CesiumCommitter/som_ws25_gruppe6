class HanoiGame:
    def __init__(self, num_disks=3):
        if num_disks < 1:
            raise ValueError("Es muss mindestens eine Scheibe vorhanden sein.")
        self.num_disks = num_disks
        # Drei Türme (Listen): A, B, C
        self.towers = [
            list(range(num_disks, 0, -1)),  # Turm A mit allen Scheiben
            [],
            []
        ]
        self.move_count = 0

    def move(self, from_tower, to_tower):
        """Führt einen Zug aus, wenn er regelkonform ist."""
        if not self.towers[from_tower]:
            raise ValueError("Kein Stein auf dem Quellturm.")
        if self.towers[to_tower] and self.towers[to_tower][-1] < self.towers[from_tower][-1]:
            raise ValueError("Eine größere Scheibe darf nicht auf eine kleinere gelegt werden.")
        disk = self.towers[from_tower].pop()
        self.towers[to_tower].append(disk)
        self.move_count += 1

    def is_solved(self):
        """Überprüft, ob das Spiel gewonnen wurde."""
        return len(self.towers[2]) == self.num_disks

    def __str__(self):
        """ASCII-Darstellung des Spielfelds."""
        lines = []
        height = self.num_disks
        tower_width = self.num_disks * 2 + 1
        base = "=" * (tower_width * 3 + 6)

        for level in range(height - 1, -1, -1):
            row = []
            for tower in self.towers:
                if len(tower) > level:
                    disk_size = tower[level]
                    disk = "X" * (disk_size * 2 - 1)
                    padding = " " * (self.num_disks - disk_size)
                    row.append(padding + disk + padding)
                else:
                    row.append(" " * self.num_disks + "|" + " " * self.num_disks)
            lines.append("  ".join(row))
        lines.append(base)
        lines.append("  ".join(["  A".center(tower_width),
                                "  B".center(tower_width),
                                "  C".center(tower_width)]))
        lines.append(f"Züge: {self.move_count}")
        return "\n".join(lines)


# Beispielverwendung:
if __name__ == "__main__":
    game = HanoiGame(num_disks=4)
    print(game)
    game.move(0, 2)
    game.move(0, 1)
    print("\nNach zwei Zügen:\n")
    print(game)
